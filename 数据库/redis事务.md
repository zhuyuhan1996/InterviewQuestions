一个事务包含了多个命令，服务器在执行事务期间，不会改去执行其他客户端的命令请求。

一个支持事务的数据库具有四种特性：原子性，一致性，隔离性，持久性（ACID）

事务中的多个命令被一次性发送给服务器，而不是一条一条发送，这种方式被称为流水线，它可以减少客户端和服务器之间的网络通信次数而提升性能。

redis最简单的事务实现方式是使用MULTI和EXEC命令将事务操作包围起来。

**1、事务开始 2、命令入队 3、事务执行**

1、MULTI命令可以将该命令的客户端从非事务状态切换到事务状态。

2、当一个客户端处于非事务状态时，这个客户端发送的命令会被立即执行；

当客户端切换到事务状态后，服务器会根据这个客户端发来的不同命令执行不同的操作。

如果为EXEC，MULTI，DISCARD，WATCH四个中的一个时，服务器立即执行这个命令；

与此相反，如果为其他命令，那么服务器不立刻执行这个命令，而是放到事务队列中，返回QUEUED回复。

每个客户端都有自己的事务状态（保存在mstate属性中），事务状态包含一个事务队列，以及一个已入队命令的计数器（也可以说是事务队列的长度）

3、执行事务

EXEC命令会立即被服务器执行，服务器会遍历客户端的事务队列执行队列中保存的所有命令，最后将执行命令的结果返回客户端。